{% extends "clawboard/base_dark.html" %}
{% load static %}

{% block title %}Verbindungen - Clawboard{% endblock %}

{% block cb_page %}
<div class="cb-page-header">
    <div>
        <div class="cb-breadcrumb">
            <a href="{% url 'clawboard:dashboard' %}">Clawboard</a>
            <span class="separator">/</span>
            <span class="current">Verbindungen</span>
        </div>
        <h1 class="cb-page-title"><i class="bi bi-plug me-2"></i>Verbindungen</h1>
    </div>
    <a href="{% url 'clawboard:connection_add' %}" class="cb-btn cb-btn-primary">
        <i class="bi bi-plus-lg me-1"></i>Neue Verbindung
    </a>
</div>

{% if connections %}
    <div class="cb-grid">
        {% for conn in connections %}
            <div class="cb-card">
                <div class="cb-card-header">
                    <h6><i class="bi bi-hdd-network me-2"></i>{{ conn.name }}</h6>
                    <span class="cb-badge {% if conn.status == 'online' %}cb-badge-green{% elif conn.status == 'offline' %}cb-badge-red{% else %}cb-badge-gray{% endif %}">
                        {{ conn.get_status_display|default:"Unbekannt" }}
                    </span>
                </div>
                <div class="cb-card-body">
                    {% if conn.gateway_url %}
                        <p style="color: #6c7086; font-size: 0.78rem; margin-bottom: 4px;">
                            <i class="bi bi-link-45deg me-1"></i>{{ conn.gateway_url|truncatechars:40 }}
                        </p>
                    {% endif %}
                    {% if conn.last_seen %}
                        <p style="color: #6c7086; font-size: 0.78rem; margin-bottom: 12px;">
                            <i class="bi bi-clock me-1"></i>Zuletzt: {{ conn.last_seen|timesince }}
                        </p>
                    {% endif %}
                    <div style="display: flex; gap: 6px;">
                        <a href="{% url 'clawboard:connection_detail' conn.pk %}" class="cb-btn cb-btn-outline cb-btn-sm">
                            <i class="bi bi-eye me-1"></i>Details
                        </a>
                        <a href="{% url 'clawboard:connection_edit' conn.pk %}" class="cb-btn cb-btn-outline cb-btn-sm">
                            <i class="bi bi-pencil me-1"></i>Bearbeiten
                        </a>
                        <a href="{% url 'clawboard:connection_delete' conn.pk %}" class="cb-btn cb-btn-danger cb-btn-sm">
                            <i class="bi bi-trash"></i>
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="cb-empty-state">
        <i class="bi bi-plug display-1"></i>
        <h4>Keine Verbindungen</h4>
        <p>Erstelle deine erste Clawdbot-Verbindung.</p>
        <a href="{% url 'clawboard:connection_add' %}" class="cb-btn cb-btn-primary">
            <i class="bi bi-plus-lg me-2"></i>Verbindung hinzufuegen
        </a>
    </div>
{% endif %}
{% endblock %}
