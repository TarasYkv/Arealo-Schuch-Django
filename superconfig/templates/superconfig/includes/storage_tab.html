<!-- Storage & Subscriptions Tab -->
<div class="tab-pane fade" id="storage-main-pane" role="tabpanel">
    <!-- Storage Overview -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card info-card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-pie text-info me-2"></i>
                        Speicher-Übersicht
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted">Verwalten Sie Speicherpläne und überwachen Sie die Speichernutzung aller Benutzer</p>

                    <div class="row">
                        <div class="col-md-3">
                            <div class="card bg-primary text-white">
                                <div class="card-body text-center">
                                    <h3 class="mb-0" id="totalUsers">-</h3>
                                    <small>Aktive Benutzer</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body text-center">
                                    <h3 class="mb-0" id="totalStorage">-</h3>
                                    <small>Gesamt-Speicher</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-dark">
                                <div class="card-body text-center">
                                    <h3 class="mb-0" id="premiumUsers">-</h3>
                                    <small>Premium Benutzer</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body text-center">
                                    <h3 class="mb-0" id="totalRevenue">-</h3>
                                    <small>Monatl. Umsatz</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Top Storage Users -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card" style="border-left: 4px solid #dc3545;">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Top Speicher-Nutzer
                    </h5>
                </div>
                <div class="card-body" id="topStorageUsers">
                    <div class="d-flex justify-content-center">
                        <div class="spinner-border text-danger" role="status">
                            <span class="visually-hidden">Lädt...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card" style="border-left: 4px solid #28a745;">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-line me-2"></i>
                        Speicher nach App
                    </h5>
                </div>
                <div class="card-body" id="storageByApp">
                    <div class="d-flex justify-content-center">
                        <div class="spinner-border text-success" role="status">
                            <span class="visually-hidden">Lädt...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Storage Logs -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card" style="border-left: 4px solid #17a2b8;">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-list me-2"></i>
                        Neueste Storage-Aktivitäten
                    </h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover" id="storageLogs">
                            <thead>
                                <tr>
                                    <th>Benutzer</th>
                                    <th>App</th>
                                    <th>Aktion</th>
                                    <th>Größe</th>
                                    <th>Zeitpunkt</th>
                                </tr>
                            </thead>
                            <tbody id="storageLogsBody">
                                <tr>
                                    <td colspan="5" class="text-center">
                                        <div class="spinner-border text-info" role="status">
                                            <span class="visually-hidden">Lädt...</span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="text-center mt-3">
                        <a href="{% url 'payments:storage_logs' %}" class="btn btn-outline-primary">
                            <i class="fas fa-external-link-alt me-2"></i>
                            Alle Storage Logs anzeigen
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Quick Links -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card" style="border-left: 4px solid #6f42c1;">
                <div class="card-header" style="background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%); color: white;">
                    <h5 class="mb-0">
                        <i class="fas fa-tools me-2"></i>
                        Admin-Verwaltung
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted">Schnellzugriff auf wichtige Admin-Bereiche</p>

                    <div class="row g-3">
                        <div class="col-md-3">
                            <a href="{% url 'payments:subscriptions_management' %}" class="btn btn-outline-primary w-100">
                                <i class="fas fa-users-cog d-block mb-2" style="font-size: 2rem;"></i>
                                <strong>Subscriptions</strong>
                                <small class="d-block text-muted">Abonnements verwalten</small>
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="{% url 'payments:storage_logs' %}" class="btn btn-outline-success w-100">
                                <i class="fas fa-list-alt d-block mb-2" style="font-size: 2rem;"></i>
                                <strong>Storage Logs</strong>
                                <small class="d-block text-muted">Speicher-Aktivitäten</small>
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="{% url 'payments:user_storage' %}" class="btn btn-outline-info w-100">
                                <i class="fas fa-hdd d-block mb-2" style="font-size: 2rem;"></i>
                                <strong>User Storage</strong>
                                <small class="d-block text-muted">Speicher-Übersicht</small>
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="{% url 'payments:webhook_events' %}" class="btn btn-outline-warning w-100">
                                <i class="fas fa-bolt d-block mb-2" style="font-size: 2rem;"></i>
                                <strong>Webhook Events</strong>
                                <small class="d-block text-muted">Stripe Webhooks</small>
                            </a>
                        </div>
                    </div>

                    <hr class="my-3">

                    <div class="row g-3">
                        <div class="col-md-4">
                            <a href="{% url 'payments:subscription_plans' %}" class="btn btn-outline-secondary w-100">
                                <i class="fas fa-crown me-2"></i>
                                Subscription Plans
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="{% url 'payments:subscription_statistics' %}" class="btn btn-outline-secondary w-100">
                                <i class="fas fa-chart-bar me-2"></i>
                                Statistiken
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="/admin/payments/invoice/" class="btn btn-outline-secondary w-100" target="_blank">
                                <i class="fas fa-file-invoice me-2"></i>
                                Invoices (Admin)
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Subscription Plans Management -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card" style="border-left: 4px solid #ffc107;">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">
                        <i class="fas fa-crown me-2"></i>
                        Subscription Plans Übersicht
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted">Verwaltung der Speicher-Abonnement-Pläne</p>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Wichtig:</strong> Pläne werden über Stripe verwaltet. Änderungen hier werden nicht automatisch zu Stripe synchronisiert.
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Plan</th>
                                    <th>Speicher</th>
                                    <th>Preis</th>
                                    <th>Intervall</th>
                                    <th>Aktiv</th>
                                    <th>Abonnenten</th>
                                </tr>
                            </thead>
                            <tbody id="subscriptionPlans">
                                <tr>
                                    <td colspan="6" class="text-center">
                                        <div class="spinner-border text-warning" role="status">
                                            <span class="visually-hidden">Lädt...</span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="text-center mt-3">
                        <a href="/payments/plans/" class="btn btn-primary" target="_blank">
                            <i class="fas fa-external-link-alt me-2"></i>
                            Öffentliche Plans-Seite ansehen
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Storage Tab Scripts (will be loaded when tab is activated)
document.getElementById('storage-main-tab')?.addEventListener('shown.bs.tab', function () {
    loadStorageStats();
});

function loadStorageStats() {
    // TODO: Implement AJAX calls to load storage statistics
    // This is a placeholder - implement actual API endpoints

    console.log('Loading storage stats...');

    // Placeholder data
    document.getElementById('totalUsers').textContent = '{{ total_users|default:"-" }}';
    document.getElementById('totalStorage').textContent = '{{ total_storage_gb|default:"-" }} GB';
    document.getElementById('premiumUsers').textContent = '{{ premium_users|default:"-" }}';
    document.getElementById('totalRevenue').textContent = '{{ monthly_revenue|default:"-" }}€';

    // Load other sections...
    loadTopStorageUsers();
    loadStorageByApp();
    loadRecentLogs();
    loadSubscriptionPlans();
}

function loadTopStorageUsers() {
    // TODO: Implement API call
    const placeholder = `
        <div class="alert alert-info mb-0">
            <i class="fas fa-info-circle me-2"></i>
            API-Endpunkt muss noch implementiert werden
        </div>
    `;
    document.getElementById('topStorageUsers').innerHTML = placeholder;
}

function loadStorageByApp() {
    // TODO: Implement API call
    const placeholder = `
        <div class="alert alert-info mb-0">
            <i class="fas fa-info-circle me-2"></i>
            API-Endpunkt muss noch implementiert werden
        </div>
    `;
    document.getElementById('storageByApp').innerHTML = placeholder;
}

function loadRecentLogs() {
    // TODO: Implement API call
    const placeholder = `
        <tr>
            <td colspan="5" class="text-center">
                <div class="alert alert-info mb-0">
                    <i class="fas fa-info-circle me-2"></i>
                    API-Endpunkt muss noch implementiert werden
                </div>
            </td>
        </tr>
    `;
    document.getElementById('storageLogsBody').innerHTML = placeholder;
}

function loadSubscriptionPlans() {
    // TODO: Implement API call
    const placeholder = `
        <tr>
            <td colspan="6" class="text-center">
                <div class="alert alert-info mb-0">
                    <i class="fas fa-info-circle me-2"></i>
                    API-Endpunkt muss noch implementiert werden
                </div>
            </td>
        </tr>
    `;
    document.getElementById('subscriptionPlans').innerHTML = placeholder;
}
</script>
