{% extends 'base.html' %}
{% load humanize %}

{% block title %}LoomAds Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h2 mb-0">
                <i class="bi bi-megaphone-fill text-warning me-2"></i>
                LoomAds Dashboard
            </h1>
            <p class="text-muted mb-0">Werbeanzeigeverwaltung für Workloom</p>
        </div>
        <div class="btn-group">
            <a href="{% url 'loomads:campaign_list' %}" class="btn btn-primary">
                <i class="bi bi-folder-plus"></i> Kampagnen
            </a>
            <a href="{% url 'loomads:auto_campaign_list' %}" class="btn btn-success">
                <i class="bi bi-robot"></i> Auto-Kampagnen
            </a>
            <a href="{% url 'loomads:app_campaign_list' %}" class="btn btn-info">
                <i class="bi bi-phone"></i> App-Kampagnen
            </a>
            <a href="{% url 'loomads:ad_list' %}" class="btn btn-outline-primary">
                <i class="bi bi-image"></i> Anzeigen
            </a>
            <a href="{% url 'loomads:zone_list' %}" class="btn btn-outline-secondary">
                <i class="bi bi-grid-3x3"></i> Zonen
            </a>
            <a href="{% url 'loomads:settings' %}" class="btn btn-outline-info">
                <i class="bi bi-gear"></i> Einstellungen
            </a>
        </div>
    </div>

    <!-- Wizard Call-to-Action -->
    <div class="alert alert-primary alert-dismissible fade show mb-4" role="alert">
        <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
                <i class="bi bi-magic fs-1 me-3"></i>
                <div>
                    <h5 class="alert-heading mb-1">
                        Neue Kampagne erstellen - Schritt für Schritt
                    </h5>
                    <p class="mb-0">
                        Nutzen Sie unseren Assistenten für eine einfache Kampagnenerstellung ohne technisches Wissen.
                    </p>
                </div>
            </div>
            <div class="text-end">
                <a href="{% url 'loomads:wizard_start' %}" class="btn btn-primary btn-lg me-2">
                    <i class="bi bi-magic"></i> Assistent starten
                </a>
                <a href="{% url 'loomads:wizard_list_drafts' %}" class="btn btn-outline-primary">
                    <i class="bi bi-file-earmark-text"></i> Entwürfe
                </a>
            </div>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <!-- Statistik-Karten -->
    <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="p-3 bg-primary bg-opacity-10 rounded-3">
                                <i class="bi bi-folder2-open text-primary fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <div class="small text-muted">Kampagnen</div>
                            <div class="h4 mb-0">{{ total_campaigns|intcomma|default:0 }}</div>
                            <div class="small text-success">
                                <i class="bi bi-check-circle"></i> {{ active_campaigns|default:0 }} aktiv
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="p-3 bg-warning bg-opacity-10 rounded-3">
                                <i class="bi bi-image text-warning fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <div class="small text-muted">Anzeigen</div>
                            <div class="h4 mb-0">
                                <a href="{% url 'loomads:ad_list' %}" class="text-decoration-none text-dark">
                                    {{ total_ads|intcomma|default:0 }}
                                </a>
                            </div>
                            <div class="small text-success">
                                <i class="bi bi-check-circle"></i> {{ active_ads|default:0 }} aktiv
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="p-3 bg-info bg-opacity-10 rounded-3">
                                <i class="bi bi-eye text-info fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <div class="small text-muted">Impressions (30d)</div>
                            <div class="h4 mb-0">{{ recent_impressions|intcomma|default:0 }}</div>
                            <div class="small text-muted">
                                <i class="bi bi-grid-3x3"></i> {{ active_zones|default:0 }} Zonen aktiv
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="p-3 bg-success bg-opacity-10 rounded-3">
                                <i class="bi bi-hand-index text-success fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <div class="small text-muted">Klicks (30d)</div>
                            <div class="h4 mb-0">{{ recent_clicks|intcomma|default:0 }}</div>
                            <div class="small {% if overall_ctr >= 2 %}text-success{% elif overall_ctr >= 1 %}text-warning{% else %}text-danger{% endif %}">
                                <i class="bi bi-percent"></i> {{ overall_ctr|floatformat:2|default:0 }}% CTR
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Quick Actions -->
        <div class="col-lg-12 mb-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-lightning-charge me-2 text-warning"></i>LoomAds Verwaltung
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <div class="d-grid">
                                <a href="{% url 'loomads:campaign_create' %}" class="btn btn-primary btn-lg">
                                    <i class="bi bi-plus-lg me-2"></i>Neue Kampagne
                                </a>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="d-grid">
                                <a href="{% url 'loomads:app_campaign_create' %}" class="btn btn-info btn-lg">
                                    <i class="bi bi-phone-vibrate me-2"></i>Neue App-Kampagne
                                </a>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="d-grid">
                                <a href="{% url 'loomads:ad_create' %}" class="btn btn-outline-primary btn-lg">
                                    <i class="bi bi-image me-2"></i>Neue Anzeige
                                </a>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="d-grid">
                                <a href="{% url 'loomads:zone_create' %}" class="btn btn-outline-secondary btn-lg">
                                    <i class="bi bi-grid-3x3 me-2"></i>Neue Zone
                                </a>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="d-grid">
                                <a href="{% url 'loomads:analytics' %}" class="btn btn-outline-dark btn-lg">
                                    <i class="bi bi-graph-up me-2"></i>Analytics
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Zweite Reihe mit Ansichten-Buttons -->
                    <hr class="my-3">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="d-grid">
                                <a href="{% url 'loomads:campaign_list' %}" class="btn btn-outline-info btn-lg">
                                    <i class="bi bi-folder2-open me-2"></i>Alle Kampagnen
                                </a>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="d-grid">
                                <a href="{% url 'loomads:ad_list' %}" class="btn btn-outline-warning btn-lg">
                                    <i class="bi bi-images me-2"></i>Alle Anzeigen
                                </a>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="d-grid">
                                <a href="{% url 'loomads:zone_list' %}" class="btn btn-outline-success btn-lg">
                                    <i class="bi bi-grid me-2"></i>Alle Zonen
                                </a>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="d-grid">
                                <a href="{% url 'loomads:settings' %}" class="btn btn-outline-danger btn-lg">
                                    <i class="bi bi-gear me-2"></i>Einstellungen
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Beispiel-Integration -->
    <div class="row">
        <div class="col-lg-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-code-slash me-2 text-info"></i>Template Integration
                    </h5>
                </div>
                <div class="card-body">
                    <p class="mb-3">So fügen Sie Werbeanzeigen in Ihre Templates ein:</p>
                    <div class="bg-light p-3 rounded">
                        <pre><code>{% templatetag openblock %} load loomads_tags {% templatetag closeblock %}
{% templatetag openblock %} loomads_css {% templatetag closeblock %}
{% templatetag openblock %} show_ad_zone 'header_main' css_class='my-ad-banner' {% templatetag closeblock %}</code></pre>
                    </div>
                    <div class="mt-3">
                        <h6>Verfügbare Template Tags:</h6>
                        <ul class="list-unstyled">
                            <li><code>{% templatetag openblock %} show_ad_zone 'zone_code' {% templatetag closeblock %}</code> - Anzeige in Zone einbetten</li>
                            <li><code>{% templatetag openblock %} show_ad_modal 'popup_zone' {% templatetag closeblock %}</code> - Modal-Anzeige</li>
                            <li><code>{% templatetag openblock %} loomads_css {% templatetag closeblock %}</code> - Styling laden</li>
                            <li><code>{% templatetag openblock %} ad_stats 30 as stats {% templatetag closeblock %}</code> - Statistiken abrufen</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    transition: transform 0.2s ease-in-out;
}

.card:hover {
    transform: translateY(-2px);
}

.btn-lg {
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
}

.bg-gradient {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
</style>
{% endblock %}